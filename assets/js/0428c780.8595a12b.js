"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[89711],{95714:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>o,default:()=>a,frontMatter:()=>r,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"mlops/storage/ceph/osd","title":"Ceph OSD \uad00\ub9ac","description":"Ceph OSD \uad00\ub9ac","source":"@site/docs/mlops/storage/ceph/osd.mdx","sourceDirName":"mlops/storage/ceph","slug":"/mlops/storage/ceph/osd","permalink":"/docs/mlops/storage/ceph/osd","draft":false,"unlisted":false,"editUrl":"https://github.com/hhk7734/wiki/tree/main/docs/mlops/storage/ceph/osd.mdx","tags":[],"version":"current","lastUpdatedAt":1739204909000,"frontMatter":{"id":"osd","title":"Ceph OSD \uad00\ub9ac","sidebar_label":"OSD \uad00\ub9ac","description":"Ceph OSD \uad00\ub9ac","keywords":["ceph","osd"]},"sidebar":"storage","previous":{"title":"Monitoring","permalink":"/docs/mlops/storage/ceph/monitoring"},"next":{"title":"PG \uad00\ub9ac","permalink":"/docs/mlops/storage/ceph/pg"}}');var l=s(74848),c=s(28453),d=s(24763);const r={id:"osd",title:"Ceph OSD \uad00\ub9ac",sidebar_label:"OSD \uad00\ub9ac",description:"Ceph OSD \uad00\ub9ac",keywords:["ceph","osd"]},o=void 0,t={},h=[{value:"Disk \uc900\ube44",id:"disk-\uc900\ube44",level:2},{value:"Raw device\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0",id:"raw-device\ub97c-\uc0ac\uc6a9\ud558\ub294-\uacbd\uc6b0",level:3},{value:"Logical Volume(LV)\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0",id:"logical-volumelv\ub97c-\uc0ac\uc6a9\ud558\ub294-\uacbd\uc6b0",level:3},{value:"Data \ud750\ub984",id:"data-\ud750\ub984",level:2},{value:"OSD \ucd94\uac00\ud558\uae30",id:"osd-\ucd94\uac00\ud558\uae30",level:2}];function x(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"disk-\uc900\ube44",children:"Disk \uc900\ube44"}),"\n",(0,l.jsx)(n.p,{children:"\uc544\ub798 \uc911 \ud558\ub098\uc5d0 \ud574\ub2f9\ud558\ub294 Disk\ub97c \uc900\ube44\ud574\uc57c\ud569\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Raw devices (\ud30c\ud2f0\uc158 \ub610\ub294 \ud30c\uc77c \uc2dc\uc2a4\ud15c\uc774 \uc5c6\ub294 \ub514\ubc14\uc774\uc2a4)"}),"\n",(0,l.jsx)(n.li,{children:"Raw partitions (\ud30c\uc77c \uc2dc\uc2a4\ud15c\uc774 \uc5c6\ub294 \ud30c\ud2f0\uc158)"}),"\n",(0,l.jsx)(n.li,{children:"LVM Logical Volumes (\ud30c\uc77c \uc2dc\uc2a4\ud15c\uc774 \uc5c6\ub294 \ub17c\ub9ac\uc801 \ubcfc\ub968)"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Block"}),"\ubaa8\ub4dc\ub85c \uc0ac\uc6a9\uac00\ub2a5\ud55c PV(\ub2e4\ub978 StorageClass\uc5d0 \uc758\ud574 \ud504\ub85c\ube44\uc800\ub2dd \ub428)"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"raw-device\ub97c-\uc0ac\uc6a9\ud558\ub294-\uacbd\uc6b0",children:"Raw device\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"sudo dd if=/dev/zero of=/dev/<device> bs=1M count=100 oflag=direct,dsync\n"})}),"\n",(0,l.jsx)(n.h3,{id:"logical-volumelv\ub97c-\uc0ac\uc6a9\ud558\ub294-\uacbd\uc6b0",children:"Logical Volume(LV)\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/linux/kernel/storage/lvm",children:"Logical Volume Manager(LVM)"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"data-\ud750\ub984",children:"Data \ud750\ub984"}),"\n",(0,l.jsxs)("center",{children:[(0,l.jsx)("img",{src:(0,d.Ay)("img/mlops/storage/ceph/data_flow.png")}),(0,l.jsx)("br",{}),(0,l.jsx)("sub",{children:(0,l.jsx)(n.a,{href:"https://access.redhat.com/documentation/en-us/red_hat_ceph_storage/4/html/storage_strategies_guide/overview",children:"https://access.redhat.com/documentation/en-us/red_hat_ceph_storage/4/html/storage_strategies_guide/overview"})})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Data","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"block device image(RBD), object(RGW), file(CephFS)"}),"\n",(0,l.jsx)(n.li,{children:"Data\ub294 \uc800\uc7a5\uc744 \uc704\ud55c Object\ub85c \ubd84\ud560\ub418\uace0(e.g. 4 MB), Object\ub294 stripe unit\uc73c\ub85c \ubd84\ud560\ub429\ub2c8\ub2e4(e.g. 64 KB)."}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.ceph.com/en/reef/architecture/#data-striping",children:"Data Striping"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Pool","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uc778\uc2dd\ud558\ub294 \ucd94\uc0c1\ud654\ub41c \uc800\uc7a5\uacf5\uac04\uc785\ub2c8\ub2e4."}),"\n",(0,l.jsx)(n.li,{children:"Pool\uc740 Placement Group(PG)\ub4e4\ub85c \ub098\ub269\ub2c8\ub2e4."}),"\n",(0,l.jsx)(n.li,{children:"\ud558\ub098\uc758 PG\ub294 \ud558\ub098\uc758 Pool\uc5d0\ub9cc \uc18d\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["CRUSH \uc54c\uace0\ub9ac\uc998","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"PG\ub97c OSD\uc5d0 \ud560\ub2f9\ud569\ub2c8\ub2e4.(primary OSD\uc640 secondary OSDs\ub85c \uad6c\uc131)"}),"\n",(0,l.jsx)(n.li,{children:"Object\ub97c PG \uc911 \ud558\ub098\uc5d0 \ud560\ub2f9\ud569\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["CRUSH \ub9f5","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Bucket \uacc4\uce35 \uad6c\uc870, OSD \ub9ac\uc2a4\ud2b8, Pool \ub0b4\uc5d0\uc11c \ub370\uc774\ud130\ub97c \ubcf5\uc81c \uaddc\uce59\uc744 \uc815\uc758\ud55c \ub9f5\uc785\ub2c8\ub2e4."}),"\n",(0,l.jsxs)(n.li,{children:["OSD\uac00 \ucd94\uac00\ub418\uba74 ",(0,l.jsx)(n.code,{children:"host"})," Bucket\uc5d0 \uc790\ub3d9\uc73c\ub85c \ucd94\uac00\ub429\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(n.li,{children:["\uae30\ubcf8\uc801\uc73c\ub85c ",(0,l.jsx)(n.code,{children:"root"}),"-",(0,l.jsx)(n.code,{children:"host"}),"-",(0,l.jsx)(n.code,{children:"osd"})," \uad6c\uc870\uac00 \uc8fc\uc5b4\uc9d1\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"root"}),"-",(0,l.jsx)(n.code,{children:"region"}),"-",(0,l.jsx)(n.code,{children:"zone"}),"-",(0,l.jsx)(n.code,{children:"datacenter"}),"-",(0,l.jsx)(n.code,{children:"room"}),"-",(0,l.jsx)(n.code,{children:"pod"}),"-",(0,l.jsx)(n.code,{children:"pdu"}),"-",(0,l.jsx)(n.code,{children:"row"}),"-",(0,l.jsx)(n.code,{children:"rack"}),"-",(0,l.jsx)(n.code,{children:"chassis"}),"-",(0,l.jsx)(n.code,{children:"host"}),"-",(0,l.jsx)(n.code,{children:"osd"})," \uad6c\uc870\ub85c \ud655\uc7a5 \uac00\ub2a5\ud569\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-shell",children:"kubectl rook-ceph ceph osd tree\n"})}),"\n",(0,l.jsx)(n.h2,{id:"osd-\ucd94\uac00\ud558\uae30",children:"OSD \ucd94\uac00\ud558\uae30"}),"\n",(0,l.jsx)(n.admonition,{title:"Reference",type:"info",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://rook.io/docs/rook/latest/CRDs/Cluster/ceph-cluster-crd",children:"Rook / CephCluster CRD"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://rook.io/docs/rook/latest/CRDs/specification/#ceph.rook.io/v1.StorageScopeSpec",children:"Rook / Speicification # StorageScopeSpec"})}),"\n"]})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: ceph.rook.io/v1\nkind: CephCluster\nspec:\n  resources:\n    osd: {}\n  placement:\n    all: {}\n    osd: {}\n  storage:\n    useAllNodes: false\n    useAllDevices: false\n"})}),"\n",(0,l.jsx)(n.admonition,{type:"warning",children:(0,l.jsxs)(n.p,{children:["\ub3d9\uc77c\ud55c \uc124\uc815\uc774 \uc788\ub294 \uacbd\uc6b0 \ubc94\uc704\uac00 \uc881\uc740 \uac83\uc774 \uc801\uc6a9\ub429\ub2c8\ub2e4. \uc608\ub97c \ub4e4\uc5b4 ",(0,l.jsx)(n.code,{children:"storage.config"}),"\uc640 ",(0,l.jsx)(n.code,{children:"storage.nodes.config"}),"\uac00 \uc788\uace0 \ud574\ub2f9 \uc7a5\uce58\uac00 \uc18d\ud55c Node\uc5d0 config\uac00 \uc788\ub294 \uacbd\uc6b0 ",(0,l.jsx)(n.code,{children:"storage.nodes.config"}),"\uac00 \uc801\uc6a9\ub429\ub2c8\ub2e4."]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"resources"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"osd: {}"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"osd-<deviceClass>: {}"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"<deviceClass>"}),"\uc5d0\ub294 ",(0,l.jsx)(n.code,{children:"hdd"}),", ",(0,l.jsx)(n.code,{children:"ssd"}),", ",(0,l.jsx)(n.code,{children:"nvme"})," \ub4f1\uc774 \uc62c \uc218 \uc788\uc2b5\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\uba54\ubaa8\ub9ac \uc124\uc815\uc740 \uc790\ub3d9\uc73c\ub85c ",(0,l.jsx)(n.code,{children:"osd_memory_target"})," \uc124\uc815\uc5d0 \uc801\uc6a9\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"placement"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"all"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"osd"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"nodeAffinity"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"podAffinity"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"podAntiAffinity"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"tolerations"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"topologySpreadConstraints"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"storage"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"config: <config>"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"deviceSelection"}),"(\uc784\ubca0\ub529)"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"storageClassDeviceSets: []"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onlyApplyOSDPlacement: <bool>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["PV\uac00 \uc544\ub2cc \uc7a5\uce58\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0 ",(0,l.jsx)(n.code,{children:".spec.placement.osd"}),"\uc640 ",(0,l.jsx)(n.code,{children:".spec.placement.all"}),"\uc758 \ubcd1\ud569 \uc5ec\ubd80\uc785\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(n.li,{children:["PV \uc7a5\uce58\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0 ",(0,l.jsx)(n.code,{children:"storageClassDeviceSets"}),"\uc5d0 \uc815\uc758\ub41c placement\uc640 ",(0,l.jsx)(n.code,{children:".spec.placement.all"}),"\uc758 \ubcd1\ud569 \uc5ec\ubd80\uc785\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"useAllNodes: <bool>"}),": \ubaa8\ub4e0 \ub178\ub4dc\uc5d0\uc11c \uc7a5\uce58\ub97c \uac10\uc9c0\ud560\uc9c0 \uc5ec\ubd80\uc785\ub2c8\ub2e4."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"nodes: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"name: <nodeName>"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"config: <config>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\ub178\ub4dc\uc5d0 \uc788\ub294 \ubaa8\ub4e0 \uc7a5\uce58\uc5d0 \uc801\uc6a9\ub420 \uc124\uc815\uc785\ub2c8\ub2e4."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"deviceSelection"}),"(\uc784\ubca0\ub529)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"resources: {}"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\uba54\ubaa8\ub9ac \uc124\uc815\uc740 \uc790\ub3d9\uc73c\ub85c ",(0,l.jsx)(n.code,{children:"osd_memory_target"})," \uc124\uc815\uc5d0 \uc801\uc6a9\ub429\ub2c8\ub2e4."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)("br",{}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"deviceSelection"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"useAllDevices: <bool>"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"deviceFilter: <deviceRegex>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://pkg.go.dev/regexp/syntax",children:"https://pkg.go.dev/regexp/syntax"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"devicePathFilter: <devicePathRegex>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://pkg.go.dev/regexp/syntax",children:"https://pkg.go.dev/regexp/syntax"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"devices: []"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"name: <device|devicePath>"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"config: <config>"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"volumeClaimTemplates: []"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)("br",{}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"<config>"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://rook.io/docs/rook/latest/CRDs/Cluster/ceph-cluster-crd/#osd-configuration-settings",children:"https://rook.io/docs/rook/latest/CRDs/Cluster/ceph-cluster-crd/#osd-configuration-settings"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["resources\uc5d0 memory \uc124\uc815\uc744 \ud558\ub294 \uacbd\uc6b0 ",(0,l.jsx)(n.code,{children:"osd_memory_target"})," \uc124\uc815\uc5d0 \ubc18\uc601\ub429\ub2c8\ub2e4. \uc2a4\ud1a0\ub9ac\uc9c0\ub9cc\uc744 \uc704\ud55c Node\uc758 \uacbd\uc6b0 ",(0,l.jsx)(n.code,{children:"osd_memory_target_autotune"}),"\uc640 ",(0,l.jsx)(n.code,{children:"autotune_memory_target_ratio"}),"\uc744 \ud65c\uc6a9\ud558\ub294 \uac83\uc774 \uc88b\uc2b5\ub2c8\ub2e4."]})]})}function a(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(x,{...e})}):x(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>r});var i=s(96540);const l={},c=i.createContext(l);function d(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);