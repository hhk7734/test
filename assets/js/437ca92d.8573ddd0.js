"use strict";(self.webpackChunkwiki_loliot_net=self.webpackChunkwiki_loliot_net||[]).push([[14338],{72441:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>m,frontMatter:()=>l,metadata:()=>r,toc:()=>c});var s=o(74848),n=o(28453);const l={id:"spot-role",title:"Spot Role",sidebar_label:"Spot Role",description:"Spot Role",keywords:["Spot Role"]},a=void 0,r={id:"mlops/mlops/aws/iam/spot-role",title:"Spot Role",description:"Spot Role",source:"@site/docs/mlops/mlops/aws/iam/spot-role.mdx",sourceDirName:"mlops/mlops/aws/iam",slug:"/mlops/mlops/aws/iam/spot-role",permalink:"/docs/mlops/mlops/aws/iam/spot-role",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1730478655e3,frontMatter:{id:"spot-role",title:"Spot Role",sidebar_label:"Spot Role",description:"Spot Role",keywords:["Spot Role"]},sidebar:"mlops",previous:{title:"Cross-Accounts Access",permalink:"/docs/mlops/mlops/aws/iam/cross-accounts-access"},next:{title:"VPC",permalink:"/docs/mlops/mlops/aws/vpc"}},i={},c=[{value:"AmazonEC2SpotFleetTaggingRole",id:"amazonec2spotfleettaggingrole",level:2},{value:"AWSServiceRoleForEC2Spot",id:"awsserviceroleforec2spot",level:2},{value:"AWSServiceRoleForEC2SpotFleet",id:"awsserviceroleforec2spotfleet",level:2}];function p(e){const t={a:"a",code:"code",h2:"h2",li:"li",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html",children:"https://docs.aws.amazon.com/batch/latest/userguide/spot_fleet_IAM_role.html"})}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"amazonec2spotfleettaggingrole",children:"AmazonEC2SpotFleetTaggingRole"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:'import * as aws from "@pulumi/aws";\nimport * as variable from "@src/variable";\n\nconst roleName = "AmazonEC2SpotFleetTaggingRole";\nconst role = new aws.iam.Role(roleName, {\n\tname: roleName,\n\tassumeRolePolicy: {\n\t\tStatement: [\n\t\t\t{\n\t\t\t\tEffect: "Allow",\n\t\t\t\tPrincipal: {\n\t\t\t\t\tService: "spotfleet.amazonaws.com",\n\t\t\t\t},\n\t\t\t\tAction: "sts:AssumeRole",\n\t\t\t},\n\t\t],\n\t\tVersion: "2012-10-17",\n\t},\n\ttags: {\n\t\tName: roleName,\n\t\t"loliot.net/stack": variable.stackName,\n\t},\n});\n\nconst policyARNs = {\n\t"0": "arn:aws:iam::aws:policy/service-role/AmazonEC2SpotFleetTaggingRole",\n};\n\nconst rpas = Object.entries(policyARNs).map(\n\t([i, arn]) =>\n\t\tnew aws.iam.RolePolicyAttachment(`AmazonEC2SpotFleetTaggingRole-rpa-${i}`, {\n\t\t\tpolicyArn: arn,\n\t\t\trole: role.name,\n\t\t}),\n);\n'})}),"\n",(0,s.jsx)(t.h2,{id:"awsserviceroleforec2spot",children:"AWSServiceRoleForEC2Spot"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"aws iam create-service-linked-role --aws-service-name spot.amazonaws.com\n"})}),"\n",(0,s.jsx)(t.h2,{id:"awsserviceroleforec2spotfleet",children:"AWSServiceRoleForEC2SpotFleet"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"aws iam create-service-linked-role --aws-service-name spotfleet.amazonaws.com\n"})})]})}function m(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},28453:(e,t,o)=>{o.d(t,{R:()=>a,x:()=>r});var s=o(96540);const n={},l=s.createContext(n);function a(e){const t=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),s.createElement(l.Provider,{value:t},e.children)}}}]);